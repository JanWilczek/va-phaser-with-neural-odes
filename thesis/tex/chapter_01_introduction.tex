%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
\label{chap:Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In recent years, we have seen a shift in the music industry towards more "vintage" or "old-school" sound. Musicians and producers seek analog equipment to add a unique flavor to their work. With a rising demand, the price of this equipment inevitably goes up, not to mention quite poor availability of certain devices. Some of them are even no longer manufactured.

The demand for analog sound caused the industry and the scientific community to look for ways to create software capable of adding vintage characteristics to modern-day, digital recordings. As a result, a whole are of research called \acf{VA} modeling appeared.

The renaissance of deep learning in 2006 resulted in successful applications of neural networks to various areas of science. With 70,000 papers published in 2020 and already 81,000 in 2021 (according to Google Scholar), the popularity of that area of machine learning does not seem to vanish soon.

Among many fields where the deep learning methodology was applied, one that benefited tremendously is the field of audio effects modeling. Analog audio effects, originally realized as analog electronic circuits, are difficult to analyze and difficult to model in software, unless the circuit's topology is very simple. With the aid of data-driven approach, distortion pedals, amplifiers, phasers, and other effects were successfully modeled using neural networks. Some of them were also deployed in commercial applications.

One historically important tool for \ac{VA} were \acfp{ODE}. This comes from the fact that analog electronic circuits can be described with differential equations relating the quantities present therein. However, the derivation of these equations is a difficult task which requires expert knowledge. Additionally, solving these equations presents an equal challenge. The computational burden of numerical solvers effectively prevents any real-time implementations and, thus, makes this method unattractive for commercial applications.

However, latest research relating deep learning and \acp{ODE} has provided a promise of being able to learn these \acp{ODE} from data what would facilitate the first step of the above process. A proper framework, enabling the usage of a simple solver, would then add a real time capability to the system and solve the second step of that process.

Therefore, the benefits of coupling a neural network with a numerical solver in \ac{VA} modeling would be manifold. First, we could derive an empirical \ac{ODE} that would replace complicated expressions containing multiple physical quantities or would enable modeling of audio effects previously not described by an \ac{ODE} using solely measured data. Second, we could possibly alleviate various problems inherent to numerical solutions of \acp{ODE} such as aliasing or long processing time. Finally, we could enable real-time performance capabilities to many analog systems, thus, letting musicians and producers everywhere use software emulations of analog hardware previously unavailable for professional applications.

This work aims to validate the \ac{ODE} approach in neural networks in applications to \ac{VA} modeling. The ultimate goal is to model a phaser pedal; a time-varying audio effect. To facilitate this goal a simpler model is examined first, namely, a diode clipper. These models are examined in the context of data needed to derive them, fidelity, complexity, aliasing, and real-time capabilities.

This work is organized as follows. Part I contains the theoretic foundations of the presented research. In \Chapter{chapter:odes_and_dl}, the basics of \acp{ODE} and deep learning are presented. As these areas are vast, only the most important aspects are explained with references pointing the reader to the relevant literature. In \Chapter{chapter:virtual_analog_modeling}, a short introduction to that research field is followed by a detailed description of the diode clipper circuit and the phaser effect. Part II of the thesis with \Chapter{chapter:experiments} contains the actual experiments, their results and discussion. The main focus is on the applicability of the \ac{ODE}-inspired deep learning approach to \ac{VA} as well as its possible advantages over other methods. Finally, \Chapter{chapter:conclusions} lists all the conclusions and indicates possible future work.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Relation to Other Work}
\label{sec:relation_to_other_work}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The aim of this work is to investigate the applicability of the ODENet architecture to \ac{VA} modeling of audio effects. In comparison to dynamical systems examined in \cite{Karlsson2019}, networks modeling audio effects need to account for the input signal, which is not only time-varying but also time-discretized with a specific sampling rate. 

\cite{Parker2019} use a \ac{MLP} to learn the residual of a state-space system. The learned mapping steers the model through the state space of the device under study. The model is named \ac{STN}. Just as the original \ac{ResNet} paper \cite{He2015}, the residual not the derivative is learned, which is equivalent to the Euler method of solving \acp{ODE}. \cite{Parker2019} successfully applies \ac{STN} to model analog clipper circuits and an analog filter.

For modeling a phaser pedal, following \cite{Wright2020}, this work estimates the \ac{LFO} signal and uses it for conditioning the network. Therefore, it falls under the category of grey-box models. However, to achieve this goal, it uses a significantly different network architecture than \cite{Wright2020}.

