%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
\label{chap:Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In recent years, we have seen a shift in the music industry towards more "vintage" or "old-school" timbres. Musicians and producers seek analog equipment to add a unique flavor to their sound \cite{Parker2013,Stilson2006,DAngelo2014}. With a rising demand, the price of this equipment inevitably goes up, not to mention the low availability of certain devices \cite{Kiiski2016}. Some of them are even no longer manufactured.

The demand for analog sound caused the industry and the scientific community to look for ways to create software capable of adding vintage characteristics to modern-day, digital recordings. As a result, a whole area of research called \ac{VA} modeling appeared \cite{Parker2013,Stilson2006,DAngelo2014,Werner2016}. \ac{VA} is a part of a broader trend of the digitalization in the music industry \cite{Zoelzer2011,Valimaki2010}. It is, thus, not only a research problem but also a commercial opportunity.

The renaissance of deep learning in 2006 resulted in successful applications of neural networks to various areas of science \cite{Goodfellow-et-al-2016}. With 70,000 papers published in 2020 and already 81,000 in 2021 (according to Google Scholar), the popularity of that area of machine learning does not seem to decline soon.

Among many fields where the deep learning methodology was applied, one that benefited tremendously is the field of audio effects modeling. Analog audio effects, originally realized as analog electronic circuits, are difficult to analyze and difficult to model in software, unless the circuit's topology is very simple. With the aid of data-driven approach, distortion pedals, amplifiers, phasers, and other effects were successfully modeled using neural networks \cite{Parker2019,Wright2019,Wright2019a,Wright2020}. Some of them were also deployed in commercial applications.

One historically important tool for \ac{VA} were \acfp{ODE} \cite{Yeh2007,Yeh2008}. This comes from the fact that analog electronic circuits can be described by differential equations relating the quantities present therein. However, the derivation of these equations is a difficult task which requires expert knowledge. Additionally, solving these equations presents an equal challenge. The computational burden of many numerical solvers effectively prevents their real-time usage and, thus, makes this method unattractive for commercial applications.

However, latest research relating deep learning and \acp{ODE} has provided a promise of being able to learn these \acp{ODE} from data what would facilitate the first step of the above process \cite{Chen2018}. The concept of teaching a neural network the derivative of a system and then supplying this learned derivative to a numerical solver was termed ODENet. A proper framework, enabling the usage of a simple solver, would then add a real time capability to the system and solve the second step of that process.

Therefore, the benefits of coupling a neural network with a numerical solver in \ac{VA} modeling would be manifold. First, we could derive an empirical \ac{ODE} that would replace complicated expressions containing multiple physical quantities or would enable modeling of audio effects previously not described by an \ac{ODE} using solely signal data. Second, we could possibly alleviate various problems inherent to numerical solutions of \acp{ODE} such as aliasing or long processing times. Finally, we could add real-time performance capabilities, thus, letting musicians and producers everywhere use software emulations of analog hardware previously unavailable for professional applications.

This work aims to validate the \ac{ODE}-inspired approach to neural networks in the context of \ac{VA} modeling. The ultimate goal is to model a phaser pedal; a time-varying audio effect. To facilitate this goal a simpler model is examined first, namely, a diode clipper. These models are evaluated in the context of data needed to derive them, fidelity, complexity, and aliasing.

This work is organized as follows. \Chapters{chapter:odes_and_dl}{chapter:virtual_analog_modeling} contain the theoretic foundations of the presented research. In \Chapter{chapter:odes_and_dl}, the basics of \acp{ODE} and deep learning are presented. As these areas are vast, only the most important aspects are explained with references pointing the reader to the relevant literature. In \Chapter{chapter:virtual_analog_modeling}, a short introduction to the research field of \ac{VA} modeling is followed by a detailed description of the diode clipper circuit and the phaser effect. \Chapter{chapter:experiments} contains the actual experiments with diode clipper and phaser modeling, their results and discussion. The main focus is on the applicability of the \ac{ODE}-inspired deep learning approach to analog systems modeling as well as its possible advantages over other methods. Finally, \Chapter{chapter:conclusions} lists all the conclusions and indicates possible future work.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Relation to Other Work}
\label{sec:relation_to_other_work}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The aim of this work is to investigate the applicability of the ODENet architecture to \ac{VA} modeling of audio effects. The concept of ODENet was introduced in \cite{Chen2018}. In comparison to dynamical systems modeling examined in \cite{Karlsson2019}, networks imitating audio effects need to account for the input signal, which is not only time-varying but also time-discretized with a specific sampling rate. 

Another \ac{ODE}-inspired architecture that is used in this thesis for learning the dynamics of a system is the \ac{RINN} with a bilinear block as proposed in \cite{Fablet2017,Ouala2019}. Originally, it was used for identifying and forecasting dynamics of geophysical systems governed by an unknown ODE.

Parker et al. \cite{Parker2019} use a \ac{MLP} to learn the residual of a state-space system. The learned mapping steers the model through the state space of the device under study. The model is named \ac{STN}. Just as in the original \ac{ResNet} paper \cite{He2015}, the residual not the derivative is learned, which (as indicated in various publications, see the introduction to \cite{Chen2018}) is equivalent to the Euler method of solving the \ac{ODE} governing the system. Parker et al. \cite{Parker2019} successfully applied the \ac{STN} to model analog clipper circuits and an analog filter.

The diode clipper circuit with the governing \ac{ODE} was presented in \cite{Yeh2007,Yeh2008}. Distortion circuit modeling using neural networks was done in \cite{Wright2019,Wright2019a, Wrightetal2020}. The architecture provided in \cite{Wright2019} was chosen as a baseline for this work.

For modeling a phaser pedal, following the approach taken in \cite{Wright2020}, this work uses a ground truth \ac{LFO} signal for conditioning the network. That \ac{LFO} signal is extracted during dataset synthesis. Therefore, the ODENet falls under the category of grey-box models. However, for the modeling itself, this work uses a significantly different network architecture than \cite{Wright2020}.

